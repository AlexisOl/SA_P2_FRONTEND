<!-- movies-grid.html -->
<div class="flex items-center justify-between mb-5">
  <h2 class="text-2xl font-bold">Películas</h2>

  <p-iconField class="w-80">
    <p-inputicon styleClass="pi pi-search" />
    <input pInputText type="text"
           [(ngModel)]="q"
           (ngModelChange)="onSearch($event)"
           placeholder="Buscar por título, director, reparto, clasificación..." />
  </p-iconField>
</div>

<!-- grid tipo “malla” -->
<div class="grid" style="gap:1rem; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));">
  <div *ngFor="let m of filtered()" class="relative overflow-hidden rounded-2xl shadow-md">
    <div class="relative">
      <img [src]="posterOf(m)"
           alt="{{ m.titulo }}"
           style="width:100%; height:340px; object-fit:cover; display:block;" />
      <!-- badges arriba -->
      <div class="absolute left-3 top-3 flex gap-2">
        <span class="px-3 py-1 rounded-full text-sm font-semibold bg-white/90 shadow">
          {{ m.clasificacion }}
        </span>
        <p-tag *ngIf="m.activa" value="EN CARTELERA" severity="success"></p-tag>
        <p-tag *ngIf="!m.activa" value="PRÓXIMAMENTE" severity="warn"></p-tag>
      </div>
      <!-- overlay gradiente -->
      <div class="absolute inset-x-0 bottom-0 p-4"
           style="background: linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.75) 60%, rgba(0,0,0,.9) 100%); color:#fff;">
        <div class="text-lg font-bold leading-tight">{{ m.titulo }}</div>
        <div class="opacity-90 text-sm line-clamp-2">{{ m.sinopsis }}</div>
        <div class="mt-2 flex items-center gap-4 text-sm opacity-90">
          <span class="pi pi-clock mr-1"></span>{{ m.duracion }} min
          <span class="pi pi-calendar ml-3 mr-1"></span>{{ m.fechaEstreno | date:'mediumDate' }}
        </div>
        <div class="mt-3">
          <button pButton type="button" label="Ver más" icon="pi pi-arrow-right"
                  (click)="openMovie(m)"
                  styleClass="p-button-success p-button-rounded"></button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- vacío -->
<p *ngIf="!loading && !filtered().length" class="text-center text-color-secondary mt-8">
  No encontramos películas que coincidan con “{{ q }}”.
</p>